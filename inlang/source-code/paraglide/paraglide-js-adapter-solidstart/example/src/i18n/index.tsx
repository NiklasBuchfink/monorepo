import { Component } from "solid-js"
import * as paraglide from "../paraglide/runtime.js" // generated by paraglide
import * as adapter from "./adapter.js"

export type AvailableLanguageTag = paraglide.AvailableLanguageTag
export const availableLanguageTags = paraglide.availableLanguageTags
export const sourceLanguageTag = paraglide.sourceLanguageTag

export function getLanguageTagFromURL(): AvailableLanguageTag | undefined {
	return adapter.getLanguageTagFromURL(availableLanguageTags)
}

export const { LanguageTagProvider, languageTag, setLanguageTag } = adapter.createI18n(paraglide)

export const LocaleSwitcher: Component = () => {
	const language_tag = languageTag()

	return (
		<select
			name="language"
			onChange={(e) => setLanguageTag(e.target.value as AvailableLanguageTag)}
		>
			{availableLanguageTags.map((tag) => (
				<option value={tag} selected={tag === language_tag}>
					{tag}
				</option>
			))}
		</select>
	)
}
